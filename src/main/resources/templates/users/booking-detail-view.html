<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layouts/head :: head}">
  <title>Chi tiết cuộc họp</title>
</head>
<body class="index-page">
<div th:replace="~{layouts/navbar :: navbar}"></div>

<main class="main" style="margin-top: 100px;">
  <section class="section">
    <div class="container">
      <div class="row justify-content-center" th:if="${b != null}">
        <div class="col-lg-8">
          <div class="card shadow-sm">
            <div class="card-header bg-primary text-white">
              <h4 class="mb-0">CHI TIẾT CUỘC HỌP</h4>
            </div>
            <div class="card-body p-4">
              <h2 class="fw-bold" th:text="${b.title}">Tiêu đề</h2>
              <p class="text-muted" th:text="${b.description}">Mô tả</p>
              <hr>

              <div class="mb-3">
                <strong>Tên phòng: </strong>
                <span th:text="${b.room != null ? b.room.name : 'Chưa gán phòng'}"></span>
                <br>
                <strong>Địa điểm: </strong>
                <span th:text="${b.room != null ? b.room.address : '---'}"></span>
              </div>
              <div class="session-detail">
                <span class="fw-bold">Ngày tổ chức: </span>
                <span th:text="${#temporals.format(b.startTime, 'dd/MM/yyyy')}">Ngày tổ chức</span>
              </div>
              <div class="session-detail">
                <span class="fw-bold">Thời gian: </span>
                <span th:text="${#temporals.format(b.startTime, 'HH:mm')} + ' - ' + ${#temporals.format(b.endTime, 'HH:mm')}">Thời gian</span>
              </div>
              <div class="mb-3">
                <strong>Người tổ chức: </strong>
                <span th:text="${b.host != null ? b.host.fullname : 'Không rõ'}"></span>
              </div>

              <div id="meet-container" style="height: 500px; width: 100%; border-radius: 10px; overflow: hidden;" class="mb-4">
              </div>

            </div>
            <div class="card-footer text-center">
              <a th:href="@{/users/history}" class="btn btn-secondary">Quay lại</a>
              <button onclick="window.print()" class="btn btn-outline-dark">In trang này</button>
            </div>
          </div>
        </div>
      </div>

      <div th:unless="${b != null}" class="alert alert-warning text-center">
        Không tìm thấy dữ liệu cuộc họp này.
      </div>
    </div>
  </section>
</main>
<div th:replace="~{layouts/footer :: footer}"></div>
<script src="https://meet.jit.si/external_api.js"></script>
<script th:inline="javascript">
  window.onload = () => {
    const roomName = "OnMeet_Room_" + [[${b.id}]];
    const domain = "meet.jit.si";
    const options = {
      roomName: roomName,
      width: "100%",
      height: 500,
      parentNode: document.querySelector('#meet-container'),
      userInfo: {
        displayName: [[${#authentication.principal.username}]]
      }
    };
    const api = new JitsiMeetExternalAPI(domain, options);
  };
</script>
</body>
</html>